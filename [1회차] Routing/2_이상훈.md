# Route Groups

기본적으로 `app` 디렉토리 하위에 존재하는 디렉토리의 이름은 라우팅되는 URL 경로에 포함됩니다.
그러나 유사한 도메인을 가진 파일끼리 같은 디렉토리에 놓고 싶은데, **URL 경로에는 영향을 주고 싶지 않다면** Route Groups 라는 개념을 활용할 수 있습니다.

사용 방법은 간단하게 디렉토리의 이름을 소괄호로 감싸면 됩니다.  
ex) `(marketing)`, `(shop)`

이런 개념이 유용한 몇 가지의 예시 상황이 존재합니다.

## URL 경로에 영향을 주지 않고 라우팅 구성하기

![image](https://github.com/prgrms-web-devcourse/FEDC4-Next-Document-Study/assets/50488780/946729e9-72ab-4c86-920f-d6efaedb6ea3)

각각 `marketing` 과 `shop` 이라는 도메인에 관심이 있는 하위 페이지들을 구성했습니다.

그런데 보시다시피 라우팅 경로는 `/about`, `/blog`, `/account` 인 것을 확인할 수 있는데, Route Groups 으로 묶은 디렉토리는 URL 경로에 영향을 주지 않는다는 점을 확인할 수 있습니다.

## 특정 요소를 레이아웃으로 뽑아서 사용하기

![image](https://github.com/prgrms-web-devcourse/FEDC4-Next-Document-Study/assets/50488780/c2f9d0cc-1d29-4c41-92a2-eacbeb4b2e03)

만약 `/account` 와 `/cart` 라는 각각의 라우팅 페이지에 공통적인 요소가 존재한다면, 상위에 `(shop)` 이라는 Route Group을 만들고, 그 아래에 공통적인 요소를 `layout.js` 로 정의할 수 있습니다.

## 최상위 layout을 여러 개 만들기

![image](https://github.com/prgrms-web-devcourse/FEDC4-Next-Document-Study/assets/50488780/b5f86666-3025-484a-b322-2eb18c34ee55)

최상위 레이아웃은 일반적으로 `app` 디렉토리 하위에 바로 `layout.js` 파일을 작성하지만, 특정 도메인마다 다른 메타정보를 갖게 하고 싶다면 Route Group을 이용할 수 있습니다.

위 예시에서는 `(marketing)` 과 `(shop)` 도메인에 해당하는 루트 레이아웃을 여러 개 작성했습니다.

## 알아두면 좋은 팁

- Route Groups 라는 개념은 URL path에 영향을 주지 않으며, 그 역할 외에는 특별한 의미를 가지진 않습니다.
- Route Groups 를 사용하다보면, <b style="color: red;">**URL 경로가 겹치도록 구성될 가능성이 있는데 주의**</b>해야 합니다!  
  예를 들어, `(marketing)/about/page.js` 과 `(shop)/about/page.js` 는 동일한 `/about` 경로를 갖게 되니 에러가 발생합니다!
- 만약 최상위에 `layout.js` 를 만들지 않은 채 Route Group 기능으로 여러 최상위 layout을 작성하면, 당신의 최상위 `page.js` 는 반드시 Route Group의 내부에 포함된 형태로 작성되어야 합니다.
  ex) `app/(marketing)/page.js`
- 최상위 layout을 넘나드는 페이지 이동은 full page load를 유발합니다!

# Dynamic Routes

만약 URL 경로에 들어갈 정확한 값을 사전에 알 수 없다면, Dynamic Routes 개념을 이용할 수 있습니다.

사용 방법은 폴더 이름을 대괄호로 감싸면 됩니다.
ex) `[id]`, `[slug]`

이렇게 정의된 Dynamic Segments 값은 `params` prop으로 전달되는데요, `layout`, `page`, `route`, 그리고 `generateMetadata` 에서 받아서 사용할 수 있습니다.

## 예시

```tsx
// app/blog/[slug]/page.tsx
export default function Page({ params }: { params: { slug: string } }) {
  return <div>My Post: {params.slug}</div>;
}
```

![image](https://github.com/prgrms-web-devcourse/FEDC4-Next-Document-Study/assets/50488780/0b7da232-8ec3-4a0f-bc04-7c39699c0859)

## 정적으로 Params 생성하기

동적인 값 Dynamic Segments를 실제 요청이 발생할 때 생성하는 게 아니라, 빌드할 때 생성할 수도 있는데요,

`generateStaticParams` 함수를 이용하면 됩니다.

### 예시

```tsx
// app/blog/[slug]/page.tsx
export async function generateStaticParams() {
  const posts = await fetch('https://.../posts').then((res) => res.json());

  return posts.map((post) => ({
    slug: post.slug,
  }));
}

export default function Page({ params }) {
  const { slug } = params;
}
```

이 방법의 장점이 있는데요.

우선 Next.js에서 `fetch` 함수로 데이터를 가져오면 자동으로 캐싱되어서 불필요한 네트워크 요청을 줄이게 됩니다.

그래서 `generateStaticParams` 함수 내부에서 `fetch` 로 데이터를 가져오면 빌드할 당시에 해당 데이터를 캐싱하게 됩니다.

만약 Layout, Page 등 다양한 컴포넌트에서 동일한 데이터를 가져오는 요청이 `generateStaticParams` 함수에 정의되어 있다면, 동일한 데이터는 그냥 캐싱된 것을 가져와서 바로 사용하면 되니까 빌드 시간이 줄어들게 됩니다.

위 예시에서는 빌드 시 모든 post의 목록을 가져와서 캐싱하고, 존재하는 post의 고유 ID인 slug를 미리 Dynamic Routes 파라미터로 만들고 있습니다.

> 추측하건데, 블로그의 콘텐츠 등 빌드된 이후에 변할 가능성이 거의 없는 데이터에 활용하면 유용할 것 같아요. (Static Site Generation)

## 다중 Segment

![image](https://github.com/prgrms-web-devcourse/FEDC4-Next-Document-Study/assets/50488780/1a298a93-86cb-469f-900d-385ff9ec3c48)

동적인 값 Dynamic Segments 는 하나의 값일 수도 있지만, 배열 형태로 여러 개를 받을 수 있습니다.

사용 방법은 디렉토리 이름을 `[...folderName]` 처럼 작성하는 것입니다.

## 선택적 다중 Segment

![image](https://github.com/prgrms-web-devcourse/FEDC4-Next-Document-Study/assets/50488780/7f2d6ba5-da20-4cc9-886f-81277459cf10)

사용 방법은 디렉토리 이름을 `[[...folderName]]` 로 대괄호를 두 번 사용하는 것입니다.

다중 Segment와 선택적 다중 Segment의 차이점은 오로지 Dynamic Segments 를 선택적으로 줄 수 있다는 것만 있습니다.

## TypeScript

```tsx
export default function Page({ params }: { params: { slug: string } }) {
  return <h1>My Page</h1>;
}
```

![image](https://github.com/prgrms-web-devcourse/FEDC4-Next-Document-Study/assets/50488780/4f28e61b-9141-4b2e-b696-ed0ceea5e57f)

TypeScript를 사용중이라면, Dynamic Segments의 타입을 명확하게 지정해야 합니다!

# Loading UI and Streaming
